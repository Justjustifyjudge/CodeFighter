Loading test data...
Loaded 289 test samples
Loading trained model...
Loading checkpoint shards: 100%|████████████████████████████████████████████████████████████████████████████| 4/4 [00:16<00:00,  4.15s/it]
Starting evaluation...
Evaluating: 100%|█████████████████████████████████████████████████████████████████████████████████████████| 73/73 [01:04<00:00,  1.13it/s]

Evaluation Results:
Accuracy: 0.6540
Avg Preference Margin: 919.4652
Sample Count: 289
Traceback (most recent call last):
  File "/workspace/hide_lyf/DPOjudge/test.py", line 163, in <module>
    json.dump(metrics, f, indent=2, ensure_ascii=False)
  File "/opt/conda/lib/python3.10/json/__init__.py", line 179, in dump
    for chunk in iterable:
  File "/opt/conda/lib/python3.10/json/encoder.py", line 431, in _iterencode
    yield from _iterencode_dict(o, _current_indent_level)
  File "/opt/conda/lib/python3.10/json/encoder.py", line 405, in _iterencode_dict
    yield from chunks
  File "/opt/conda/lib/python3.10/json/encoder.py", line 325, in _iterencode_list
    yield from chunks
  File "/opt/conda/lib/python3.10/json/encoder.py", line 405, in _iterencode_dict
    yield from chunks
  File "/opt/conda/lib/python3.10/json/encoder.py", line 438, in _iterencode
    o = _default(o)
  File "/opt/conda/lib/python3.10/json/encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type bool_ is not JSON serializable
Traceback (most recent call last):
  File "/workspace/hide_lyf/DPOjudge/test.py", line 163, in <module>
    json.dump(metrics, f, indent=2, ensure_ascii=False)
  File "/opt/conda/lib/python3.10/json/__init__.py", line 179, in dump
    for chunk in iterable:
  File "/opt/conda/lib/python3.10/json/encoder.py", line 431, in _iterencode
    yield from _iterencode_dict(o, _current_indent_level)
  File "/opt/conda/lib/python3.10/json/encoder.py", line 405, in _iterencode_dict
    yield from chunks
  File "/opt/conda/lib/python3.10/json/encoder.py", line 325, in _iterencode_list
    yield from chunks
  File "/opt/conda/lib/python3.10/json/encoder.py", line 405, in _iterencode_dict
    yield from chunks
  File "/opt/conda/lib/python3.10/json/encoder.py", line 438, in _iterencode
    o = _default(o)
  File "/opt/conda/lib/python3.10/json/encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type bool_ is not JSON serializable
